var __cloudconnect=function(c){var y=function(d){function r(a){if(!a)return alert("UI load error."),!1;var b=document.createElement("div");document.body.insertBefore(b,document.body.firstChild);b.innerHTML=a;return!0}function l(a,b){if("connect"==d.type){b=document.getElementById("us-connect-name-textbox");if(""==b.value)return alert(a.IDS_NAME+" "+a.IDS_ERR_MSG_EMPTY_FIELD),b.focus(),!1;var c=document.getElementById("us-connect-hp-textbox");if(""==c.value)return alert(a.IDS_HP+" "+a.IDS_ERR_MSG_EMPTY_FIELD),c.focus(),!1;var f=document.getElementById("us-connect-birth-textbox");if(""==f.value)return alert(a.IDS_BIRTH+" "+a.IDS_ERR_MSG_EMPTY_FIELD),f.focus(),!1;a=document.getElementById("us-connect-auto-connect-checkbox");d.onConfirm({type:"connect",name:b.value,hp:c.value,birth:f.value,autoConn:a.checked})}else if(b)d.onConfirm({type:"mo",err:b});else{var g=!0;document.getElementById("us-btn").classList.forEach(function(a){"us-cloud-btn-disable"==a&&(g=!1)});if(g)d.onConfirm({type:"mo",err:b?b:null})}return!0}var h=function(){var a=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");a.open("GET",c.ESVS.SRCPath+"unisignweb/rsrc/layout/cloudconnect.html?version="+c.ver,!1);a.send(null);return a.responseText},m=function(){var a=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP.3.0");a.open("GET",c.ESVS.SRCPath+"unisignweb/rsrc/lang/"+c.ESVS.Language+"/cloudconnect_"+c.ESVS.Language+".js?version="+c.ver,!1);a.send(null);return a.responseText},g=c.ESVS.TabIndex;return function(){var a=c.CustomEval(h),b=c.CustomEval(m,!0);r(a());a=document.getElementById("us-div-connect-pnl");var e=document.getElementById("us-div-mo-pnl"),f=document.getElementById("us-lbl-title");f.appendChild(document.createTextNode(b.IDS_CONNECT_TITLE));f.setAttribute("tabindex",g++,0);var k=document.getElementById("us-btn");k.setAttribute("value",b.IDS_CONNECT_CONFIRM,0);if("connect"==d.type){e.style.display="none";e.style.visibility="hidden";a.style.display="block";a.style.visibility="visible";f=document.getElementById("us-cls-img-btn");f.setAttribute("title",b.IDS_CLOSE,0);f=document.getElementById("us-cls-btn-img");f.setAttribute("src",c.ESVS.SRCPath+"unisignweb/rsrc/img/cert_close_btn.png",0);f.setAttribute("alt",b.IDS_CLOSE,0);f.setAttribute("tabindex",g++,0);document.getElementById("us-connect-name-lbl").appendChild(document.createTextNode(b.IDS_NAME));var p=document.getElementById("us-connect-name-textbox");p.setAttribute("tabindex",g++,0);p.setAttribute("placeholder",b.IDS_MSG_NAME);p.setAttribute("title",b.IDS_NAME_TITLE);d.args&&d.args.name&&(p.value=d.args.name);document.getElementById("us-connect-hp-lbl").appendChild(document.createTextNode(b.IDS_HP));a=document.getElementById("us-connect-hp-textbox");a.setAttribute("tabindex",g++,0);a.setAttribute("placeholder",b.IDS_MSG_HP);a.setAttribute("title",b.IDS_HP_TITLE);d.args&&d.args.hp&&(a.value=d.args.hp);a.onkeypress=function(a){a=a?a:event;a.returnValue=48>a.keyCode||57<a.keyCode?!1:!0};document.getElementById("us-connect-birth-lbl").appendChild(document.createTextNode(b.IDS_BIRTH));a=document.getElementById("us-connect-birth-textbox");a.setAttribute("tabindex",g++,0);a.setAttribute("placeholder",b.IDS_MSG_BIRTH);a.setAttribute("title",b.IDS_BIRTH_TITLE);d.args&&d.args.birth&&(a.value=d.args.birth);a=document.getElementById("us-connect-auto-connect-checkbox");a.setAttribute("tabindex",g++,0);a.setAttribute("title",b.IDS_AUTO_CONNECT_TITLE);document.getElementById("us-connect-auto-connect-lbl").appendChild(document.createTextNode(b.IDS_AUTO_CONNECT));k.setAttribute("tabindex",g++,0);k.classList.remove("us-cloud-btn-disable");k.onclick=function(){l(b)};var q=document.getElementById("us-cls-img-btn");q.setAttribute("title",b.IDS_CLOSE,0);q.onclick=function(){d.onCancel()};f=document.getElementById("us-cls-btn-img");f.setAttribute("tabindex",g++,0);q.onkeydown=function(a){a=a||window.event;var b=a.which||a.keyCode;9==b&&a.shiftKey&&(q.onblur=function(){setTimeout(function(){k.focus()},10)});9!=b||a.shiftKey||(q.onblur=function(){setTimeout(function(){p.focus()},10)})};var w=!1;f.onkeyup=function(a){a=a||window.event;9==(a.which||a.keyCode)&&a.shiftKey&&w&&(w=!1,setTimeout(function(){k.focus()},10))};f.onkeydown=function(a){a=a||window.event;if(9==(a.which||a.keyCode)&&a.shiftKey)return a.cancelBubble=!0,w=a.returnValue=!0,!1}}else{f=document.getElementById("us-cls-img-btn");f.style.visibility="hidden";f=document.getElementById("us-cls-btn-img");f.style.visibility="hidden";e.style.display="block";e.style.visibility="visible";a.style.display="none";a.style.visibility="hidden";document.getElementById("us-mo-caption").appendChild(document.createTextNode(b.IDS_MO_CAPTION));a=d.args.authCode;e=d.args.authCodeTime;var y=d.args.authStatus;document.getElementById("us-lbl-mo-title").appendChild(document.createTextNode(b.IDS_AUTH_CODE));e=(new Date(e.replace(/[.-]/gi,"/"))).getTime();f=(new Date).getTime();var t=(e-f)/1E3,z,n,A=document.getElementById("authtime"),u=document.getElementById("authcode");u.innerText=a;var v=setInterval(function(){--t;z="0"+parseInt(t/60);n=""+parseInt(t%60);n=1==n.length?"0"+n:n;A.innerText=z+":"+n;0==t&&clearInterval(v);var a=y();switch(a.code){case 0:k.classList.remove("us-cloud-btn-disable");clearInterval(v);break;case 5201:alert(b.IDS_ERR_MSG_INCORRECT_CODE1+a.error_count+b.IDS_ERR_MSG_INCORRECT_CODE2);break;case 5202:clearInterval(v);l(b,{errCode:a.code,errMsg:b.IDS_ERR_MSG_TIMEOUT});break;case 5204:clearInterval(v),l(b,{errCode:a.code,errMsg:b.IDS_ERR_MSG_VERIFY_FAIL})}},1E3);k.onclick=function(){l(b)};k.setAttribute("tabindex",g++,0);k.onkeydown=function(a){a=a||window.event;9==(a.which||a.keyCode)&&(k.onblur=function(){setTimeout(function(){u.focus()},10)})};var x=!1;u.onkeyup=function(a){a=a||window.event;9==(a.which||a.keyCode)&&x&&(x=!1,setTimeout(function(){k.focus()},10))};u.onkeydown=function(a){a=a||window.event;if(9==(a.which||a.keyCode)&&a.shiftKey)return a.cancelBubble=!0,x=a.returnValue=!0,!1}}return document.getElementById("us-div-cloud")}()};return function(d){var r=c.uiLayerLevel,l=c.uiUtil().getOverlay(r),h=y({type:d.type,args:d.args,onConfirm:d.onConfirm,onCancel:d.onCancel});h.style.zIndex=r+1;c.ESVS.TargetObj.insertBefore(l,c.ESVS.TargetObj.firstChild);var m=window.onresize;return{show:function(){c.ActiveUI=this;draggable(h,document.getElementById("us-div-cloud-title"));l.style.display="block";var g=document.getElementById("us-div-cert-select"),a=document.getElementById("us-div-cert-manage");if(g||a){h.style.width="connect"==d.type?"345px":"440px";var b=null,e=null;g?(e=document.getElementById("us-div-list"),b=60+g.offsetTop+e.offsetTop,e=g.offsetLeft+e.offsetLeft,e="connect"==d.type?e+100:e+60):a&&(e=document.getElementById("us-div-cert-manage-list"),b=60+a.offsetTop+e.offsetTop,e=a.offsetLeft+e.offsetLeft,e="connect"==d.type?e+100:e+60);c.uiUtil().offsetResize(h,b+","+e)}else c.uiUtil().offsetResize(h);window.onresize=function(){h&&(h.style.left=c.uiUtil().getScrollLeft()+(c.uiUtil().getViewportWidth()-c.uiUtil().getNumSize(c.uiUtil().getStyle(h,"width","width")))/2+"px");if(g){var b=document.getElementById("us-div-list");b=60+g.offsetTop+b.offsetTop;h.style.top=b+"px"}else a&&(b=document.getElementById("us-div-cert-manage-list"),b=60+a.offsetTop+b.offsetTop,h.style.top=b+"px");m&&m()};c.uiLayerLevel+=10;c.ESVS.TabIndex+=30;setTimeout(function(){"connect"==d.type?document.getElementById("us-connect-name-textbox").focus():document.getElementById("us-btn").focus()},10)},hide:function(){l.style.display="none";h.style.display="none"},dispose:function(){window.onresize=function(){m&&m()};h.parentNode.parentNode.removeChild(h.parentNode);l.parentNode.removeChild(l);c.uiLayerLevel-=10;c.ESVS.TabIndex-=30}}}};